<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaxLLM | Your AI Tax Expert</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        appleGray: '#F5F5F7',
                        appleDark: '#1D1D1F',
                        appleBlue: '#0066CC',
                    },
                    boxShadow: {
                        'soft': '0 10px 30px -10px rgba(0, 0, 0, 0.08)',
                        'card': '0 4px 20px rgba(0, 0, 0, 0.06)',
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; }
        
        /* Glassmorphism */
        .glass-nav { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(0,0,0,0.05); }
        
        /* Smooth Transitions */
        .fade-in { animation: fadeIn 0.6s ease-out forwards; opacity: 0; transform: translateY(20px); }
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 10px; }
        
        /* Markdown Styling */
        .prose h3 { font-weight: 600; font-size: 1.1em; margin-top: 1.5em; margin-bottom: 0.5em; color: #111; }
        .prose ul { list-style-type: disc; padding-left: 1.2em; margin-bottom: 1em; color: #374151; }
        .prose p { margin-bottom: 0.8em; color: #374151; line-height: 1.6; }
        .prose strong { color: #000; font-weight: 600; }
        .prose a { color: #0066CC; text-decoration: none; }
        .prose a:hover { text-decoration: underline; }
        
        /* Feature Tiles */
        .feature-tile { transition: all 0.3s ease; }
        .feature-tile:hover { transform: translateY(-5px); box-shadow: 0 20px 40px -10px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="bg-white text-appleDark">

    <div id="landing-view">
        
        <nav class="fixed w-full z-50 glass-nav">
            <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
                <div class="font-bold text-xl tracking-tight">Tax<span class="font-light text-gray-500">LLM</span></div>
                <div class="hidden md:flex space-x-8 text-sm font-medium text-gray-500">
                    <a href="#" class="hover:text-black transition">Product</a>
                    <a href="#" class="hover:text-black transition">Features</a>
                    <a href="#pricing" class="hover:text-black transition">Pricing</a>
                    <a href="#" class="hover:text-black transition">Library</a>
                </div>
                <div class="flex gap-4 text-sm">
                    <button class="text-gray-600 hover:text-black font-medium">Sign In</button>
                    <button onclick="switchView('app')" class="bg-black text-white px-5 py-2 rounded-full font-medium hover:bg-gray-800 transition transform hover:scale-105">Get Started</button>
                </div>
            </div>
        </nav>

        <section class="pt-40 pb-20 px-6 text-center max-w-4xl mx-auto fade-in" style="animation-delay: 0.1s;">
            <h1 class="text-5xl md:text-7xl font-semibold tracking-tight mb-6 leading-tight text-black">Your AI Tax Expert.</h1>
            <p class="text-xl md:text-2xl text-gray-500 font-light mb-10">Accurate. Cited. Country-specific. Trusted by professionals.</p>
            
            <div class="relative max-w-2xl mx-auto mb-16 group">
                <div class="absolute inset-y-0 left-0 pl-5 flex items-center pointer-events-none">
                    <i class="fa-solid fa-magnifying-glass text-gray-400 text-lg"></i>
                </div>
                <input type="text" onclick="switchView('app')" class="w-full pl-14 pr-4 py-5 rounded-full border border-gray-200 shadow-soft text-lg focus:outline-none focus:ring-4 focus:ring-gray-100 transition cursor-pointer" placeholder="Ask anything about tax..." readonly>
                <div class="absolute right-2 top-2">
                    <button onclick="switchView('app')" class="bg-blue-600 text-white w-12 h-12 rounded-full flex items-center justify-center hover:bg-blue-700 transition shadow-lg">
                        <i class="fa-solid fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </section>

        <section class="px-6 pb-24 max-w-7xl mx-auto fade-in" style="animation-delay: 0.3s;">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div onclick="switchView('app')" class="feature-tile bg-appleGray p-8 rounded-3xl cursor-pointer h-full flex flex-col items-center text-center">
                    <div class="w-14 h-14 bg-white rounded-2xl flex items-center justify-center shadow-sm mb-6 text-xl text-gray-700"><i class="fa-solid fa-magnifying-glass"></i></div>
                    <h3 class="text-xl font-semibold mb-2">Tax Search</h3>
                    <p class="text-gray-500 text-sm leading-relaxed">Search tax laws with real citations and direct government links.</p>
                </div>
                <div onclick="switchView('app')" class="feature-tile bg-appleGray p-8 rounded-3xl cursor-pointer h-full flex flex-col items-center text-center">
                    <div class="w-14 h-14 bg-white rounded-2xl flex items-center justify-center shadow-sm mb-6 text-xl text-gray-700"><i class="fa-solid fa-globe"></i></div>
                    <h3 class="text-xl font-semibold mb-4">Tax Summaries</h3>
                    <div class="flex gap-2 w-full mb-3 opacity-50 pointer-events-none">
                        <div class="bg-white px-3 py-2 rounded-lg text-xs border w-1/2">USA</div>
                        <div class="bg-white px-3 py-2 rounded-lg text-xs border w-1/2">Corp Tax</div>
                    </div>
                    <p class="text-gray-500 text-sm leading-relaxed">Summaries for any country and tax category.</p>
                </div>
                <div onclick="switchView('app')" class="feature-tile bg-appleGray p-8 rounded-3xl cursor-pointer h-full flex flex-col items-center text-center">
                    <div class="w-14 h-14 bg-white rounded-2xl flex items-center justify-center shadow-sm mb-6 text-xl text-gray-700"><i class="fa-solid fa-envelope-open-text"></i></div>
                    <h3 class="text-xl font-semibold mb-4">Email Generator</h3>
                    <div class="w-full bg-black text-white py-2 rounded-lg text-xs font-medium mb-3 opacity-80">Generate Email</div>
                    <p class="text-gray-500 text-sm leading-relaxed">Create professional tax emails instantly.</p>
                </div>
            </div>
        </section>

        <section class="bg-white py-24 px-6 border-t border-gray-100">
            <div class="max-w-6xl mx-auto">
                <h2 class="text-3xl md:text-4xl font-semibold text-center mb-16">Everything You Need for Tax</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
                    <div class="p-6 border border-gray-100 rounded-2xl hover:border-gray-300 transition flex items-center gap-4 group cursor-default">
                        <i class="fa-solid fa-file-pdf text-gray-400 group-hover:text-black text-xl transition"></i> <span class="font-medium text-gray-700">Document Helper</span>
                    </div>
                    <div class="p-6 border border-gray-100 rounded-2xl hover:border-gray-300 transition flex items-center gap-4 group cursor-default">
                        <i class="fa-solid fa-gavel text-gray-400 group-hover:text-black text-xl transition"></i> <span class="font-medium text-gray-700">Case Law Explorer</span>
                    </div>
                    <div class="p-6 border border-gray-100 rounded-2xl hover:border-gray-300 transition flex items-center gap-4 group cursor-default">
                        <i class="fa-solid fa-scale-balanced text-gray-400 group-hover:text-black text-xl transition"></i> <span class="font-medium text-gray-700">Tax Comparisons</span>
                    </div>
                    <div class="p-6 border border-gray-100 rounded-2xl hover:border-gray-300 transition flex items-center gap-4 group cursor-default">
                        <i class="fa-solid fa-list-check text-gray-400 group-hover:text-black text-xl transition"></i> <span class="font-medium text-gray-700">Checklists</span>
                    </div>
                    <div class="p-6 border border-gray-100 rounded-2xl hover:border-gray-300 transition flex items-center gap-4 group cursor-default">
                        <i class="fa-regular fa-calendar text-gray-400 group-hover:text-black text-xl transition"></i> <span class="font-medium text-gray-700">Tax Calendar</span>
                    </div>
                    <div class="p-6 border border-gray-100 rounded-2xl hover:border-gray-300 transition flex items-center gap-4 group cursor-default">
                        <i class="fa-solid fa-clipboard-question text-gray-400 group-hover:text-black text-xl transition"></i> <span class="font-medium text-gray-700">Form Helper</span>
                    </div>
                    <div class="p-6 border border-gray-100 rounded-2xl hover:border-gray-300 transition flex items-center gap-4 group cursor-default">
                        <i class="fa-solid fa-copy text-gray-400 group-hover:text-black text-xl transition"></i> <span class="font-medium text-gray-700">Templates Library</span>
                    </div>
                    <div class="p-6 border border-gray-100 rounded-2xl hover:border-gray-300 transition flex items-center gap-4 group cursor-default">
                        <i class="fa-solid fa-diagram-project text-gray-400 group-hover:text-black text-xl transition"></i> <span class="font-medium text-gray-700">Saved Workflows</span>
                    </div>
                    <div class="p-6 border border-gray-100 rounded-2xl hover:border-gray-300 transition flex items-center gap-4 group cursor-default">
                        <i class="fa-solid fa-sliders text-gray-400 group-hover:text-black text-xl transition"></i> <span class="font-medium text-gray-700">Tone & Detail Control</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-20 bg-appleGray px-6 text-center">
            <p class="text-xs font-bold uppercase tracking-widest text-gray-400 mb-10">Verified by Official Sources</p>
            <div class="flex flex-wrap justify-center gap-8 md:gap-16 text-xl md:text-2xl text-gray-400 font-bold grayscale opacity-60 select-none">
                <span>HMRC</span><span>IRS</span><span>ITD India</span><span>ATO</span><span>CRA</span><span>EU Commission</span>
            </div>
            <p class="mt-10 text-sm text-gray-500">Every answer includes citations to real legislation.</p>
        </section>

        <section id="pricing" class="py-24 px-6 max-w-6xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-end">
                <div class="p-8 rounded-3xl border border-gray-200 text-center bg-white">
                    <h3 class="text-lg font-semibold mb-2">Free</h3>
                    <div class="text-4xl font-bold mb-4">$0</div>
                    <p class="text-gray-500 mb-8 text-sm">For individuals.</p>
                    <button onclick="switchView('app')" class="w-full border border-gray-200 py-3 rounded-xl font-medium hover:bg-gray-50 transition text-sm">Get Started</button>
                </div>
                <div class="p-8 rounded-3xl bg-black text-white text-center shadow-xl transform scale-105 relative z-10">
                    <h3 class="text-lg font-semibold mb-2">Pro</h3>
                    <div class="text-4xl font-bold mb-4">$29</div>
                    <p class="text-gray-400 mb-8 text-sm">For tax professionals.</p>
                    <button onclick="switchView('app')" class="w-full bg-white text-black py-3 rounded-xl font-medium hover:bg-gray-100 transition text-sm">Start Trial</button>
                </div>
                <div class="p-8 rounded-3xl border border-gray-200 text-center bg-white">
                    <h3 class="text-lg font-semibold mb-2">Enterprise</h3>
                    <div class="text-4xl font-bold mb-4">Custom</div>
                    <p class="text-gray-500 mb-8 text-sm">For firms & teams.</p>
                    <button class="w-full border border-gray-200 py-3 rounded-xl font-medium hover:bg-gray-50 transition text-sm">Contact Sales</button>
                </div>
            </div>
        </section>

        <footer class="py-10 border-t border-gray-100 text-center text-xs text-gray-400">
            <div class="flex justify-center gap-6 mb-4">
                <a href="#" class="hover:text-black">About</a>
                <a href="#" class="hover:text-black">Security</a>
                <a href="#" class="hover:text-black">Terms</a>
                <a href="#" class="hover:text-black">Contact</a>
            </div>
            <p>&copy; 2025 TaxLLM. Built for professionals.</p>
        </footer>
    </div>

    <div id="app-view" class="hidden h-screen flex bg-white font-sans text-gray-900">
        
        <aside class="w-[260px] bg-[#202123] text-gray-200 flex flex-col h-full border-r border-gray-800 flex-shrink-0">
            <div class="p-3">
                <button onclick="resetChat()" class="w-full border border-gray-600 hover:bg-[#2A2B32] text-white rounded-md py-3 px-3 flex items-center gap-3 text-sm transition text-left">
                    <i class="fa-solid fa-plus"></i> New Chat
                </button>
            </div>
            
            <div class="flex-1 overflow-y-auto px-3 py-2 space-y-1 custom-scroll">
                <div class="text-[10px] font-semibold text-gray-500 uppercase tracking-wider px-2 mt-4 mb-1">Tools</div>
                
                <button class="w-full flex items-center gap-3 px-3 py-3 rounded hover:bg-[#2A2B32] text-sm transition text-left"><i class="fa-solid fa-magnifying-glass w-4"></i> Tax Search</button>
                <button class="w-full flex items-center gap-3 px-3 py-3 rounded hover:bg-[#2A2B32] text-sm transition text-left"><i class="fa-solid fa-globe w-4"></i> Tax Summaries</button>
                <button class="w-full flex items-center gap-3 px-3 py-3 rounded hover:bg-[#2A2B32] text-sm transition text-left"><i class="fa-solid fa-envelope-open-text w-4"></i> Email Generator</button>
                <button class="w-full flex items-center gap-3 px-3 py-3 rounded hover:bg-[#2A2B32] text-sm transition text-left"><i class="fa-solid fa-file-pdf w-4"></i> Document Helper</button>
                <button class="w-full flex items-center gap-3 px-3 py-3 rounded hover:bg-[#2A2B32] text-sm transition text-left"><i class="fa-solid fa-gavel w-4"></i> Case Law</button>
                
                <div class="text-[10px] font-semibold text-gray-500 uppercase tracking-wider px-2 mt-6 mb-1">History</div>
                <button class="w-full flex items-center gap-3 px-3 py-3 rounded hover:bg-[#2A2B32] text-sm transition text-left text-gray-400 truncate"><i class="fa-regular fa-message w-4"></i> VAT Threshold UK</button>
                <button class="w-full flex items-center gap-3 px-3 py-3 rounded hover:bg-[#2A2B32] text-sm transition text-left text-gray-400 truncate"><i class="fa-regular fa-message w-4"></i> Section 199A Deduction</button>
            </div>

            <div class="p-3 border-t border-gray-700">
                <button onclick="switchView('landing')" class="w-full flex items-center gap-3 px-3 py-3 rounded hover:bg-[#2A2B32] text-sm transition text-left">
                    <div class="w-6 h-6 bg-blue-600 rounded flex items-center justify-center text-[10px] text-white font-bold">U</div>
                    User
                </button>
            </div>
        </aside>

        <main class="flex-1 flex flex-col h-full relative bg-white">
            
            <header class="h-14 border-b border-gray-100 flex items-center justify-between px-6 bg-white/90 backdrop-blur z-10">
                <div class="font-semibold text-gray-700">TaxLLM <span class="bg-gray-100 text-gray-500 text-[10px] px-1.5 py-0.5 rounded ml-2">PRO</span></div>
                <div class="flex items-center gap-4 text-sm">
                    <div class="flex items-center gap-2 text-gray-500 text-xs bg-gray-50 px-2 py-1 rounded-md">
                        <i class="fa-solid fa-location-dot"></i> Auto: Global
                    </div>
                    <div class="flex items-center gap-2 cursor-pointer">
                        <span class="text-gray-400 text-xs">Simple</span>
                        <i class="fa-solid fa-toggle-on text-black text-xl"></i>
                        <span class="font-medium text-xs">Expert</span>
                    </div>
                </div>
            </header>

            <div id="chat-container" class="flex-1 overflow-y-auto p-6 pb-40 scroll-smooth">
                
                <div id="welcome-screen" class="h-full flex flex-col items-center justify-center text-center max-w-2xl mx-auto">
                    <div class="w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center text-3xl mb-6 text-gray-400">
                        <i class="fa-solid fa-scale-balanced"></i>
                    </div>
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">How can I help with your taxes?</h2>
                    
                    <div class="grid grid-cols-2 gap-4 w-full mt-8">
                        <button onclick="sendPreset('Summarize Corporate Tax rates for 2025')" class="p-4 border border-gray-200 rounded-xl text-left hover:bg-gray-50 transition group">
                            <div class="font-medium text-sm mb-1 text-gray-700">Summarize Tax Rates</div>
                            <div class="text-xs text-gray-400">Corporate rates for 2025</div>
                        </button>
                        <button onclick="sendPreset('Draft a penalty appeal letter to HMRC')" class="p-4 border border-gray-200 rounded-xl text-left hover:bg-gray-50 transition group">
                            <div class="font-medium text-sm mb-1 text-gray-700">Draft Appeal Letter</div>
                            <div class="text-xs text-gray-400">Professional correspondence</div>
                        </button>
                        <button onclick="sendPreset('Search case law regarding Home Office expenses')" class="p-4 border border-gray-200 rounded-xl text-left hover:bg-gray-50 transition group">
                            <div class="font-medium text-sm mb-1 text-gray-700">Search Case Law</div>
                            <div class="text-xs text-gray-400">Find legal precedents</div>
                        </button>
                        <button onclick="sendPreset('Compare VAT thresholds: UK vs UAE')" class="p-4 border border-gray-200 rounded-xl text-left hover:bg-gray-50 transition group">
                            <div class="font-medium text-sm mb-1 text-gray-700">Compare VAT</div>
                            <div class="text-xs text-gray-400">Global registration limits</div>
                        </button>
                    </div>
                </div>

                <div id="chat-output" class="max-w-3xl mx-auto space-y-8 hidden pt-4"></div>
                <div id="loading" class="hidden max-w-3xl mx-auto pt-4 flex gap-4"><div class="w-8 h-8 bg-green-600 rounded-md"></div><div class="text-sm text-gray-500 animate-pulse">Analyzing legislation...</div></div>
            </div>

            <div class="absolute bottom-0 w-full bg-gradient-to-t from-white via-white to-transparent pt-10 pb-8 px-6">
                <div class="max-w-3xl mx-auto relative">
                    <div class="relative shadow-card rounded-xl border border-gray-200 bg-white overflow-hidden focus-within:border-gray-400 focus-within:shadow-md transition">
                        <textarea id="user-input" rows="1" class="w-full p-4 pr-12 resize-none focus:outline-none text-sm max-h-40" placeholder="Ask TaxLLM..." onkeydown="if(event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); sendMessage(); }"></textarea>
                        <button onclick="sendMessage()" class="absolute right-2 bottom-2 bg-black text-white w-8 h-8 rounded-lg hover:bg-gray-800 transition flex items-center justify-center">
                            <i class="fa-solid fa-paper-plane text-xs"></i>
                        </button>
                    </div>
                    <div class="text-center mt-2 text-[10px] text-gray-400">
                        TaxLLM can make mistakes. Verify with official sources.
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script>
        // --- STATE ---
        let currentView = 'landing';

        // --- VIEW SWITCHING ---
        function switchView(viewName) {
            document.getElementById('landing-view').classList.add('hidden');
            document.getElementById('app-view').classList.add('hidden');
            
            if (viewName === 'app') {
                document.getElementById('app-view').classList.remove('hidden');
            } else {
                document.getElementById('landing-view').classList.remove('hidden');
            }
        }

        // --- CHAT LOGIC ---
        function resetChat() {
            document.getElementById('welcome-screen').classList.remove('hidden');
            document.getElementById('chat-output').classList.add('hidden');
            document.getElementById('chat-output').innerHTML = '';
            document.getElementById('user-input').value = '';
        }

        function sendPreset(text) {
            document.getElementById('user-input').value = text;
            sendMessage();
        }

        async function sendMessage() {
            const input = document.getElementById('user-input');
            const text = input.value.trim();
            if (!text) return;

            // UI Updates
            document.getElementById('welcome-screen').classList.add('hidden');
            const output = document.getElementById('chat-output');
            output.classList.remove('hidden');
            
            // User Message
            const userDiv = document.createElement('div');
            userDiv.className = "flex justify-end";
            userDiv.innerHTML = `<div class="bg-[#F7F7F8] text-gray-800 px-5 py-3 rounded-2xl max-w-xl text-sm leading-relaxed">${text}</div>`;
            output.appendChild(userDiv);
            
            input.value = '';
            document.getElementById('loading').classList.remove('hidden');
            window.scrollTo(0, document.body.scrollHeight);

            // --- API CALL TO YOUR BACKEND ---
            // This connects to the /api/chat.js file we built earlier
            try {
                const SYSTEM_PROMPT = `
                You are TaxLLM. FORMAT YOUR RESPONSE EXACTLY LIKE THIS:
                
                ### Executive Summary
                (3 sentences max)
                
                ### Explanation
                (Detailed explanation)
                
                ### Legislative References
                (List specific laws/sections)
                
                ### Risk Level
                (Low/Medium/High)
                
                ### Key Takeaways
                (Bullet points)
                `;

                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt: `${SYSTEM_PROMPT}\n\nUser Query: ${text}` })
                });

                const data = await response.json();
                document.getElementById('loading').classList.add('hidden');

                // AI Message
                const aiDiv = document.createElement('div');
                aiDiv.className = "flex gap-4 group fade-in";
                aiDiv.innerHTML = `
                    <div class="w-8 h-8 bg-green-600 text-white rounded-sm flex items-center justify-center flex-shrink-0 text-xs font-bold">T</div>
                    <div class="prose prose-sm max-w-none text-gray-800 leading-7">
                        ${marked.parse(data.response || "Error connecting to AI.")}
                    </div>
                `;
                output.appendChild(aiDiv);

            } catch (err) {
                document.getElementById('loading').classList.add('hidden');
                const errDiv = document.createElement('div');
                errDiv.className = "text-red-500 text-sm text-center";
                errDiv.innerText = "Error: Could not connect to backend. (Make sure you are on Vercel)";
                output.appendChild(errDiv);
            }
            
            window.scrollTo(0, document.body.scrollHeight);
        }
    </script>
</body>
</html>
